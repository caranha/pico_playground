pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

cur_draw = 1

old_individual = {}
old_ptable = {}
old_score = 0
new_individual = {}
new_ptable = {}
new_score = 0
target = nil

function _init()
	cls()
	spr(1+cur_draw*113,0,0,8,8) 
	target = get_ptable(0,0)
end

function _update60()
	
	new_ptable = get_ptable(64,64)
	new_score = comp_tables(new_ptable,target)
	if new_score > old_score then
		old_score = new_score
		old_individual = new_individual
		old_ptable = new_ptable
	end
	
	new_individual = mut_add(old_individual)
end

function _draw()
	--cls()
	spr(1+cur_draw*113,0,0,8,8) 

	rectfill(64,64,128,128,0)
	for r in all(new_individual) do
		r:draw(64,64)
	end
	
	rectfill(64,0,128,40,0)
	print(stat(0)/2048,100,1,10)
	print(stat(1),100,8,10)
	print(#new_individual,100,15,10)

end
-->8
-- helper functions

function random_rect()
	local r = {
		x0 = rnd(64),
		y0 = rnd(64),
		h = rnd(16)-8,
		w = rnd(16)-8,
		c = rnd(16),
		draw = function(this,x,y)
										rectfill(x+this.x0,y+this.y0,x+this.x0+this.h,y+this.y0+this.w,this.c)
									end,
		copy = function(this)
										ret = {}
										for k, v in pairs(this) do
					      ret[k] = v
						    end
						    return ret
									end
		}
	return r
end

function get_ptable(x,y)
	local r = {}
	for i = 0,64 do
		for j = 0,64	do
			add(r,pget(x+i,y+j))
		end
	end
	return r
end

function comp_tables(t1,t2,c)
	local sum = 0
	for i = 1,4096 do
		--local j = ceil(rnd(16384))
		if (t1[i] == t2[i]) sum += 1
	end
	return sum
end

function mut_add(ind)
	new = {}
	for r in all(ind) do
		add(new,r:copy())
	end
	add(new,random_rect())
	return new
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000000000000000000aaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000aaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000
000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000
000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000
000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaa11111aaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaa11111aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
00000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
00000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
000000000000000aaaaaaaaaa11111aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000000aaaaaaaaa11111aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000000aaaaaaaaa11111aaaaaaaaaaaaaaaaaaaa11111aaaaaaa000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaaaaa11111aaaaaaaaaaaaaaaaaaaa11111aaaaaaa000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaaaaa111111aaaaaaaaaaaaaaaaaaa11111aaaaaaa000000000000000000000000000000000000000000000000000000000000000000
000000000000000000aaaaaaa1111111aaaaaaaaaaaaaaaaa111111aaaaaaa000000000000000000000000000000000000000000000000000000000000000000
000000000000000000aaaaaaa1111111aaaaaaaaaaaaaaaaa111111aaaaaaa000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000aaaaaa11111111aaaaaaaaaaaaaaa1111111aaaaaa0000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000aaaaaa1111111aaaaaaaaaaaaaaa1111111aaaaa00000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000aaaaaa11111111aaaaaaaaaaaaa1111111aaaaaa00000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaa111111111111111111111111111aaaaaa00000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaa111111111111111111111111111aaaaaa00000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaaa1111111111111111111111111aaaaaa000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000aaaaaa111111111111111111111111aaaaaa0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000aaaaaa1111111111111111111111aaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000aaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa0000000000000000000000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa0000000000000000000000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa0000000000000000000000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa0000000000000000aaa000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa000aaa0000000000aaaa00aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaa000aaa0000000000aaaa00aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaa00aaa0aaa00aaa00aaaa0aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaa0aaa0aaa00aaa00aaaa0aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaa0aaa0aaa00aaaa00aaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000aaaaaaa0aaa00aaaa00aaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000aaaaaaa0aaa00aaaaa00aaa0aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000aaaaaaa0aaa000aaaa00aaa0aaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000aaaaaa0aaaa00aaaa00aaaa0aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaaaaaa000aaa00aaaa00aaa08888000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaa0aaa000aaaa00aaa0000088888000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaa0aaaa00aaaa00aaaa000888888000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000aaaaaaaaaaa00aaaa00aaaa088888888000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000aaaaaa0aaaa00aaa000aaa888888888000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000888000aaaaaaaaa0aaa880aaa888888888000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000888888aaaa0aaaa8aaa888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000888888aaaa8aaaa8888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888880888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000888888888888aaaaa8888aaaaaaa888888000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000008888888888aaaaaaaaaaaaaaaaaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000008888888aaaaaaaaaaaaaaaaaaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000008888888aaaaa8aaaaaaaa88aaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000888888aaaa888aaaaaa888aaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000088888aaa8888aaaaa8888aaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000088888aaa88888aaaa8888aaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000008888aaa88888aaa88888aaa888888800000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000006666668888aaa8888888888888aaa888888866660000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000006666668888aaa8888888888888aaa888888866666660000000000000000000000000000000000000000000000000000000000000000000
0000000000000000066666668888aaa8888888888888aaa888888866666666600000000000000000000000000000000000000000000000000000000000000000
0000000000000000666666668888aaa8888888888888aaa888888866666666600000000000000000000000000000000000000000000000000000000000000000
0000000600000006666666666888aaa8888888888888888888888866666666660000000000000000000000000000000000000000000000000000000000000000
00000666000006666666666668888888888888888888888888888866666666666000000000000000000000000000000000000000000000000000000000000000
00000666000006666666666668888888888888888888888888888866666666666000000000000000000000000000000000000000000000000000000000000000
00000666000006666666666666888888888888888888888888888866666666666000000000000000000000000000000000000000000000000000000000000000
00000666000006666666666666688888888888888888888888888666666666666000000000000000000000000000000000000000000000000000000000000000
00000666000006666666666666666888888888888888888888888666666666666000000000000000000000000000000000000000000000000000000000000000
00000066000000666666666666666668888888888888888888886666666666666000000000000000000000000000000000000000000000000000000000000000
00000066000000666666666666666666688888888888888888866666666666666000000000000000000000000000000000000000000000000000000000000000
00000006000000066666666666666666666666666666666666666666666666660000000000000000000000000000000000000000000000000000000000000000
00000000000000006666666666666666666666666666666666666666666666000000000000000000000000000000000000000000000000000000000000000000
00000000000000000066666666666666666666666666666666666666000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000006666666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000006666666660000000000000000000000000000000000000000000000000000000000000000000000000000000
